(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5fb0c688"],{"0e30":function(t,e,o){"use strict";o("7db9")},"7db9":function(t,e,o){},c985:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"readIdCard"},[o("h2",[t._v("二代身份证读卡器演示")]),o("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[o("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[o("span",[t._v("基础描述")])]),o("div",{staticClass:"text item"},[o("p",[o("strong",[t._v("硬件设备：")]),t._v("诺塔斯 NTS-L7-2IN1 二合一读卡器")]),o("p",[o("strong",[t._v("exe软件见引用资源：")]),t._v("LocalWsServer20200706.zip")]),o("p",[o("strong",[t._v("电脑系统：")]),t._v("win7/10")]),o("p",{staticStyle:{"margin-top":"2rem"}},[o("strong",[t._v("说明：")])]),o("p",{staticStyle:{"text-indent":"2em"}},[t._v("先将硬件设备插入电脑，然后打开LocalWsServer软件，在软件配置中配置账号密码，并勾选自动读取，接着保存参数即可。")]),o("p",{staticStyle:{"text-indent":"2em"}},[t._v("测试账号：20002")]),o("p",{staticStyle:{"text-indent":"2em"}},[t._v("测试密码：123456")]),o("p",{staticStyle:{"text-indent":"2em"}},[t._v(" 正式账号在"),o("a",{attrs:{href:"http://www.shenfenshibie.com/",target:"_blank",rel:"noopener"}},[t._v("http://www.shenfenshibie.com/")]),t._v(" 申请，并联系设备商审核 ")])])]),o("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[o("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[o("span",[t._v("本页面将把lotussmart，暴露到window变量中，调用方法示例：")])]),o("div",{staticClass:"text item"},[o("layui-code",{attrs:{code:"// 该方法仅适用于自动读卡\nlotussmart.sfz.runReadIDCard({\n    onmessage: (cardInfo)=>{\n        console.log(cardInfo)\n    }\n})",title:"自动读取身份证信息"}})],1)]),o("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[o("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[o("span",[t._v("直接测试")])]),o("div",{staticClass:"text item"},[o("p",{staticStyle:{"text-align":"center"}},[t._v("使用本控制台测试时，请先打开LocalWsServer工具。并按照基础描述配置后再进行测试")]),o("el-divider"),o("el-row",{attrs:{gutter:25}},[o("el-col",{attrs:{xs:24,sm:24,md:15,lg:15,xl:15}},[o("el-form",{ref:"form",attrs:{"label-position":"top",model:t.form,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"服务状态"}},[o("el-tag",{attrs:{type:t.form.state.type}},[t._v(t._s(t.form.state.msg))])],1),o("el-form-item",{attrs:{label:"照片"}},[o("el-image",{staticStyle:{width:"102px",height:"126px"},attrs:{src:t.form.photo,"preview-src-list":[t.form.photo]}},[o("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[o("i",{staticClass:"el-icon-picture-outline"})])])],1),t.form.log?o("el-form-item",{attrs:{label:"日志"}},[o("div",{staticClass:"showLog"},[o("el-input",{attrs:{type:"textarea",rows:15,size:"medium"},model:{value:t.form.log,callback:function(e){t.$set(t.form,"log",e)},expression:"form.log"}})],1)]):t._e()],1)],1),o("el-col",{attrs:{xs:24,sm:24,md:9,lg:9,xl:9}},[o("el-form",{ref:"form",attrs:{"label-position":"left",model:t.form,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"服务IP"}},[o("el-input",{model:{value:t.form.ip,callback:function(e){t.$set(t.form,"ip",e)},expression:"form.ip"}})],1),o("el-form-item",{attrs:{label:"服务端口"}},[o("el-input",{model:{value:t.form.port,callback:function(e){t.$set(t.form,"port",e)},expression:"form.port"}})],1),o("el-divider",{attrs:{"content-position":"center"}},[t._v("命令模拟")]),t._l(t.commands,(function(e,s){return o("el-form-item",{key:s,attrs:{label:e.title}},[o("el-button",{on:{click:function(o){return t.execStringCommand(e.command)}}},[t._v(t._s(e.command))])],1)}))],2)],1)],1)],1)])],1)},n=[],a=(o("99af"),o("ac1f"),o("1276"),o("b855")),r=function(){var t=this;t.config={strIp:"127.0.0.1",strPort:"31213",logs:"",setLog:!1},t.wsUrl="",t.socket=null,t.nCommandIndex=0,t.data=""};r.prototype.set=function(t){var e=this;return t.vm&&(e.vm=t.vm),e.config=a["a"].extend(!0,e.config,t),e},r.prototype.setLog=function(){for(var t,e,o=this,s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return"function"===typeof o.config.setLog?(t=o.config.setLog).call.apply(t,[o].concat(n)):!!o.config.setLog&&(e=console).log.apply(e,n)},r.prototype.connectServer=function(t){var e=this,o=document.location.protocol;t=a["a"].extend(!0,{onopen:{},onclose:{},onmessage:{},onerror:{}},e.config,t);try{e.nCommandIndex=0,e.wsUrl="https:"===o?"wss://"+e.config.strIp+":"+e.config.strPort:"ws://"+e.config.strIp+":"+e.config.strPort,e.socket=new WebSocket(e.wsUrl)}catch(s){return e.setLog("#new WebSocket error:"+s.data),void(e.socket=null)}e.socket.onopen=function(o){e.setLog("#msg: 服务器连接成功"),"function"===typeof t.onopen&&t.onopen.call(e,o)},e.socket.onclose=function(o){e.setLog("#断开连接:"+o.wasClean),"function"===typeof t.onclose&&t.onclose.call(e,o)},e.socket.onmessage=function(o){var s=[];e.strLastResult=o.data,s=e.strLastResult.split(","),"ReadId"===s[0]||"ReadIdBuffer"===s[0]?s.length>11?(e.data=s[3]+"|"+s[4]+"|"+s[5]+"|"+s[6]+"|"+s[7]+"|"+s[8]+"|"+s[9]+"|"+s[10]+"|data:image/jpg;base64,"+s[11],e.setLog("#收到数据:"+e.data)):e.setLog("#收到数据:"+o.data):"ReadIdJpeg"===s[0]&&s.length>3&&s[3].length>200?(e.data=e.photo="data:image/jpg;base64,"+s[3],e.setLog("#收到数据:"+e.photo)):e.setLog("#收到数据:"+o.data),"function"===typeof t.onmessage&&t.onmessage.call(e,o,e.data)},e.socket.onerror=function(o){e.setLog("#disconnected:"+(o.message||"服务未启用或服务地址错误")),"function"===typeof t.onerror&&t.onerror.call(e,o)}},r.prototype.getSocketStatus=function(){var t=this;if(null==t.socket)return t.setLog("未连接websocket服务"),"0";switch(t.socket.readyState){case t.socket.CONNECTING:return t.setLog("websocket服务连接中"),"1";case t.socket.OPEN:return t.setLog("websocket服务连接成功"),"2";case t.socket.CLOSING:return t.setLog("websocket服务关闭中"),"3";case t.socket.CLOSED:return t.setLog("websocket服务已关闭"),"4";default:return t.setLog("未知错误"),"-1"}},r.prototype.execStringCommand=function(t){var e=this;return e.strLastResult="",e.nCommandIndex++,"2"===e.getSocketStatus()?e.socket.send(t+","+e.nCommandIndex):e.setLog("#send failed. websocket not open. please check."),e},r.prototype.runReadIDCard=function(t){var e=this,o=e.getSocketStatus();return"function"===typeof t.onopen?t.onopen=function(s){t.onopen.call(e,s),"1"!==o&&"0"!==o||e.execStringCommand("ReadIdBuffer")}:t.onopen=function(t){"1"!==o&&"0"!==o||e.execStringCommand("ReadIdBuffer")},"2"!==o?e.connectServer(t):e.execStringCommand("ReadIdBuffer")},r.prototype.getLast=function(){return this.data},r.prototype.closeConnection=function(){var t=this;t.execStringCommand("CloseConnection")};var c={sfz:new r},i=o("e436"),l=o("d8ca"),m={name:"Test",components:{LayuiCode:i["a"]},data(){return{form:{ip:"127.0.0.1",port:"31213",state:{type:"info",msg:"未连接"},photo:"",log:""},commands:[{title:"连接服务",command:"ConnectServer"},{title:"关闭连接",command:"CloseConnection"},{title:"连接状态",command:"ConnectionStatus"},{title:"MCU序列号",command:"GetMcuSerailNo"},{title:"蜂鸣",command:"Beep"},{title:"读二代证",command:"ReadId"},{title:"读二代证缓冲",command:"ReadIdBuffer"},{title:"读照片",command:"ReadIdJpeg"},{title:"清除读取缓冲",command:"ClearIdBuffer"},{title:"清除日志",command:"ClearLog"}],loading:!1}},created(){},mounted(){window.lotussmart=c},methods:{setLog(...t){if("string"===typeof t[0]){let e="";e+=l["a"].date("Y-m-d H:i:s")+"\n",e+=t[0]+"\n\n",this.form.log=e+this.form.log}},execStringCommand(t){let e=c.sfz.set({strIp:this.form.ip,strPort:this.form.port,setLog:this.setLog,onopen:()=>{this.form.state={type:"success",msg:"Socket 服务连接成功"},this.loading.close()},onclose:()=>{this.form.state={type:"warning",msg:"Socket 服务已关闭"},this.loading.close()},onerror:()=>{this.form.state={type:"danger",msg:"Socket Error"},this.loading.close()}});switch(t){case"ConnectServer":return this.loading=this.$loading({lock:!0,text:"服务连接中。。。",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),e.connectServer();case"CloseConnection":return e.socket.close(),this.form.state={type:"warning",msg:"Socket 服务已关闭"};case"ConnectionStatus":let t=e.getSocketStatus();switch(!0){case"0"===t:this.form.state={type:"info",msg:"未连接"};break;case"1"===t||"2"===t:this.form.state={type:"success",msg:"Socket 服务连接成功"};break;case"3"===t||"4"===t:this.form.state={type:"warning",msg:"Socket 服务已关闭"};break;default:this.form.state={type:"danger",msg:"Socket Error"}}return!0;case"ReadIdJpeg":e.set({onmessage:(t,e)=>{this.setLog(t.data);let o=t.data.split(",");o.length>3&&(o[3].length>200?this.form.photo="data:image/jpg;base64,"+o[3]:this.$message.error(o[3]))}});break;case"ClearLog":return this.form.log=""}return e.execStringCommand(t)}}},d=m,f=(o("0e30"),o("2877")),g=Object(f["a"])(d,s,n,!1,null,null,null);e["default"]=g.exports}}]);
//# sourceMappingURL=chunk-5fb0c688.dad33a6d.js.map